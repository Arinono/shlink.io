import Callout from '../../components/Callout';

## Environment variables

After installing Shlink, you will have to set it up, and customize different aspects of its behavior. One way to do this is via **environment variables**.

This is the complete list of supported env vars. Right next to their name you will find the version in which they were introduced:

* `DEFAULT_DOMAIN` *(v2.9.0)* : The default short domain used for this shlink instance. For example **doma.in**.
* `USE_HTTPS` *(v2.9.0)* : Tells if Shlink is served with https or not (`true` or `false`). Falls back to `SHORT_DOMAIN_SCHEMA` if not provided.
* ~~`SHORT_DOMAIN_HOST`~~: *Deprecated since v2.9.0. Use `DEFAULT_DOMAIN` instead*.
* ~~`SHORT_DOMAIN_SCHEMA`~~: Either **http** or **https**. *Deprecated since v2.9.0. Use `USE_HTTPS` instead*.
* `DB_DRIVER`: **sqlite** (which is the default value), **mysql**, **maria**, **postgres** or **mssql**.
* `DB_NAME`: The database name to be used when using an external database driver. Defaults to **shlink**.
* `DB_USER`: The username credential to be used when using an external database driver.
* `DB_PASSWORD`: The password credential to be used when using an external database driver.
* `DB_HOST`: The host name of the database server when using an external database driver.
* `DB_PORT`: The port in which the database service is running when using an external database driver.
  * Default value is based on the value provided for `DB_DRIVER`:
    * **mysql** or **maria** -> `3306`
    * **postgres** -> `5432`
    * **mssql** -> `1433`
* `DB_UNIX_SOCKET` *(v2.5.0)* : Alternatively to the `DB_HOST`, you can provide this to connect through unix sockets when using `mysql`, `maria` or `postgres` drivers.
* `DELETE_SHORT_URL_THRESHOLD`: The amount of visits on short URLs which will not allow them to be deleted. Defaults to `15`.
* ~~`VALIDATE_URLS`~~: Boolean which tells if shlink should validate a status 20x is returned (after following redirects) when trying to shorten a URL. Defaults to `false`. *Deprecated*
* `BASE_PATH`: The base path from which you plan to serve shlink, in case you don't want to serve it from the root of the domain. Defaults to `''`.
* `DEFAULT_INVALID_SHORT_URL_REDIRECT` *(v2.10.0)* : If a URL is provided here, when a user tries to access an invalid short URL, and the visited domain does not have a redirect URL of its own, he/she will be redirected to this value. If this env var is not provided, the user will see a generic `404 - not found` page.
* `DEFAULT_REGULAR_404_REDIRECT` *(v2.10.0)* : If a URL is provided here, when a user tries to access a URL not matching any supported by the router, and the visited domain does not have a redirect URL of its own, he/she will be redirected to this value. If this env var is not provided, the user will see a generic `404 - not found` page.
* `DEFAULT_BASE_URL_REDIRECT` *(v2.10.0)* : If a URL is provided here, when a user tries to access Shlink's base URL, and the visited domain does not have a redirect URL of its own, he/she will be redirected to this value. If this env var is not provided, the user will see a generic `404 - not found` page.
* ~~`INVALID_SHORT_URL_REDIRECT_TO`~~: *Deprecated since v2.10.0. Use `DEFAULT_INVALID_SHORT_URL_REDIRECT` instead*.
* ~~`REGULAR_404_REDIRECT_TO`~~: *Deprecated since v2.10.0. Use `DEFAULT_REGULAR_404_REDIRECT` instead*.
* ~~`BASE_URL_REDIRECT_TO`~~: *Deprecated since v2.10.0. Use `DEFAULT_BASE_URL_REDIRECT` instead*.
* `WEB_WORKER_NUM`: The amount of concurrent http requests this shlink instance will be able to serve. Defaults to 16. Relevant only when serving Shlink with swoole or openswoole.
* `TASK_WORKER_NUM`: The amount of concurrent background tasks this shlink instance will be able to execute. Defaults to 16. Relevant only when serving Shlink with swoole or openswoole.
* `VISITS_WEBHOOKS`: A comma-separated list of URLs that will receive a `POST` request when a short URL receives a visit.
* `NOTIFY_ORPHAN_VISITS_TO_WEBHOOKS` *(v2.9.0)* : Used to enable sending orphan visits to the webhooks configured in `VISITS_WEBHOOKS`. Default value is `false`.
* `DEFAULT_SHORT_CODES_LENGTH` *(v2.1.0)* : The length you want generated short codes to have. It defaults to 5 and has to be at least 4, so any value smaller than that will fall back to 4.
* `GEOLITE_LICENSE_KEY` *(v2.1.4)* : The license key used to download new GeoLite2 database files. This is not mandatory, as a default license key is provided, but it is **strongly recommended** that you provide your own. Go to [GeoLite2 license key](/documentation/geolite-license-key) to know how to generate it.
* `REDIS_SERVERS`: A comma-separated list of redis servers where Shlink locks are stored (locks are used to prevent some operations to be run more than once in parallel).
* `REDIS_SENTINEL_SERVICE` *(v2.9.0)* : The name of the sentinel service if you want to use redis sentinel. If this value is provided, the servers provided in `REDIS_SERVERS` will be considered sentinel instances.
* `MERCURE_PUBLIC_HUB_URL` *(v2.2.0)* : The public URL of a mercure hub server to which Shlink will sent updates. This URL will also be served to consumers that want to subscribe to those updates.
* `MERCURE_INTERNAL_HUB_URL` *(v2.2.0)* : An internal URL for a mercure hub. Will be used only when publishing updates to mercure, and does not need to be public. If this is not provided but `MERCURE_PUBLIC_HUB_URL` was, the former one will be used to publish updates.
* `MERCURE_JWT_SECRET` *(v2.2.0)* : The secret key that was provided to the mercure hub server, in order to be able to generate valid JWTs for publishing/subscribing to that server.
* `REDIRECT_STATUS_CODE` *(v2.3.0)* : Either **301** or **302**. Used to determine if redirects from short to long URLs should be done with a 301 or 302 status. Defaults to 302.
* `REDIRECT_CACHE_LIFETIME` *(v2.3.0)* : Allows to set the amount of seconds that redirects should be cached when redirect status is 301. Default values is 30.
* `REDIRECT_APPEND_EXTRA_PATH` *(v2.8.0)* : Makes Shlink match short URLs as long as they start with a known short code, appending the rest of the path to the long URL before redirection. Default values is `false`. (See [Extra path forwarding](/documentation/some-features/#extra-path-forwarding) for more info).
* `PORT` *(v2.4.0)* : Can be used to set the port in which shlink listens. Defaults to 8080 (Some cloud providers, like Google cloud or Heroku, expect to be able to customize exposed port by providing this env var).
* `AUTO_RESOLVE_TITLES` *(v2.6.0)* : Used to automatically resolve the short URL's title based on the `<title />` tag in the long URL. Defaults to `false`.
* `DISABLE_TRACK_PARAM`: The name of a query param that can be used to visit short URLs avoiding the visit to be tracked. This feature won't be available if no value is provided. (See [Tracking visits](/documentation/tracking-visits/) for more info)
* `DISABLE_TRACKING_FROM`: A comma-separated list of IP address patterns from which all tracking should be disabled. It allows providing fixed IP addresses (`100.200.80.40`), CIDR blocks (`192.168.10.0/24`) or wildcard patterns (`11.22.*.*`)
* `TRACK_ORPHAN_VISITS` *(v2.6.0)* : Tells if [orphan visits](/documentation/tracking-visits/#orphan-visits) should be tracked or not. Defaults to `true`. (See [Tracking visits](/documentation/tracking-visits/) for more info)
* `DISABLE_TRACKING` *(v2.7.0)* : Tells if visits tracking should be completely disabled. Defaults to `false`. (See [Tracking visits](/documentation/tracking-visits/) for more info)
* `DISABLE_IP_TRACKING` *(v2.7.0)* : Tells if tracking of the IP address (and therefore visitors location) should be disabled. Defaults to `false`. (See [Tracking visits](/documentation/tracking-visits/) for more info)
* `ANONYMIZE_REMOTE_ADDR` *(v2.2.0)* : Tells if IP addresses from visitors should be obfuscated before storing them in the database. Default value is `true`. (See [Tracking visits](/documentation/tracking-visits/) for more info)
<Callout type="warning">
  Setting this to <b>false</b> will make your Shlink instance no longer be in compliance with the GDPR and other similar data protection regulations.
</Callout>
* `DISABLE_REFERRER_TRACKING` *(v2.7.0)* : Tells if tracking of the referrer should be disabled. Defaults to `false`. (See [Tracking visits](/documentation/tracking-visits/) for more info)
* `DISABLE_UA_TRACKING` *(v2.7.0)* : Tells if tracking of the user agent should be disabled. Defaults to `false`. (See [Tracking visits](/documentation/tracking-visits/) for more info)
* `DEFAULT_QR_CODE_SIZE` *(v2.9.0)* : A value between 50 and 1000 to determine the default size of generated QR codes when the `size` query param is not provided. Defaults to 300.
* `DEFAULT_QR_CODE_MARGIN` *(v2.9.0)* : A value greater than 0 to determine the default margin of generated QR codes when the `margin` query param is not provided. Defaults to 0.
* `DEFAULT_QR_CODE_FORMAT` *(v2.9.0)* : One of **png** or **svg**, to determine the default format of generated QR codes when the `format` query param is not provided. Defaults to png.
* `DEFAULT_QR_CODE_ERROR_CORRECTION` *(v2.9.0)* : One of **L** (Low), **M** (Medium), **Q** (Quartile) or **H** (High), to determine the default error correction of generated QR codes when the `errorCorrection` query param is not provided. Defaults to l.
* `DEFAULT_QR_CODE_ROUND_BLOCK_SIZE` *(v2.10.0)* : Tells if the block size should be round on QR codes, making it more readable, but potentially adding some extra margin as a side effect. Defaults to `true`.

### Specific for the docker image

These are the env vars that only make sense for the docker image:

* `ENABLE_PERIODIC_VISIT_LOCATE` *(v2.8.0)* : If provided with value `true`, it schedules the `visit:locate` command to be run every hour inside the container using crontab. Defaults to `false`.

### Considerations

There are a few things to have in mind.

* Shlink has always supported configuration via environment variables when using the official docker image. However, it only supports env vars for other approaches since v2.9.0
* Shlink also supports providing configuration options via the so called "install tool" (`bin/install` script). This is an interactive CLI tool that generates some "hardcoded" configuration after being executed.
  This configuration will always take precedence over env vars, so you cannot combine the two of them.
